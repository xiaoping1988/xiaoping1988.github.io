(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d228eef"],{dafb:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-card",{attrs:{shadow:"never"}},[a("el-row",{staticClass:"d-row d-search-form"},[a("el-select",{staticClass:"item",attrs:{size:"small",clearable:"",filterable:"",placeholder:"库名,可搜索"},on:{change:e.setTableData},model:{value:e.searchForm.dbId,callback:function(t){e.$set(e.searchForm,"dbId",t)},expression:"searchForm.dbId"}},e._l(e.allDbList,function(e){return a("el-option",{key:e.id,attrs:{value:e.id,label:e.dbName}})}),1),a("el-input",{staticClass:"item",attrs:{size:"small",clearable:"",placeholder:"表关键词搜索","suffix-icon":"el-icon-search"},on:{change:e.setTableData},model:{value:e.searchForm.tbName,callback:function(t){e.$set(e.searchForm,"tbName",t)},expression:"searchForm.tbName"}})],1),a("el-row",{staticClass:"d-row"},[a("el-table",{attrs:{data:e.tableData.data}},[a("el-table-column",{attrs:{prop:"tbName",label:"表名"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("router-link",{attrs:{to:"/data-map/tb-manage/"+t.row.id}},[e._v(e._s(t.row.tbName))])]}}])}),a("el-table-column",{attrs:{prop:"tbNameCn",label:"中文名",width:"300"}}),a("el-table-column",{attrs:{prop:"tagList",label:"标签",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"d-tag-group"},e._l(t.row.tagList,function(t){return a("el-tag",{key:t.id,attrs:{size:"mini",effect:"plain"}},[e._v(e._s(t.name))])}),1)]}}])}),a("el-table-column",{attrs:{prop:"dbName",label:"数据库",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("router-link",{attrs:{to:"/data-map/db-manage/"+t.row.dbId}},[e._v(e._s(t.row.dbName))])]}}])}),a("el-table-column",{attrs:{label:"操作",width:"250"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return e.openGrantUserForm(t.row)}}},[e._v("授权用户")]),a("el-button",{attrs:{type:"text",size:"mini"}},[e._v("编辑")])]}}])})],1)],1),a("el-row",{staticClass:"d-right-pagination"},[a("el-pagination",{attrs:{background:"","current-page":e.pageNo,"page-sizes":[10,20,50,100],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next",total:e.tableData.total},on:{"current-change":e.setTableData,"size-change":e.setTableData,"update:currentPage":function(t){e.pageNo=t},"update:current-page":function(t){e.pageNo=t},"update:pageSize":function(t){e.pageSize=t},"update:page-size":function(t){e.pageSize=t}}})],1),a("el-dialog",{attrs:{title:"授权用户表："+e.currentTb.dbName+"."+e.currentTb.tbName,visible:e.grantUserFormVisible},on:{"update:visible":function(t){e.grantUserFormVisible=t}}},[a("el-row",{staticStyle:{"margin-bottom":"20px"}},[a("el-select",{staticStyle:{float:"right",width:"220px"},attrs:{filterable:"","reserve-keyword":"",multiple:"",remote:"",placeholder:"请输入用户名或姓名,搜索添加",size:"small","remote-method":e.searchUser},on:{change:e.selectUser},model:{value:e.userNameList,callback:function(t){e.userNameList=t},expression:"userNameList"}},e._l(e.searchUserList,function(t,s){return a("el-option",{key:t.userName,attrs:{label:t.userNameCn,value:t.userName}},[a("span",{staticStyle:{float:"left"}},[e._v(e._s(t.userNameCn)+"("+e._s(t.userName)+")")]),a("span",{staticStyle:{float:"right"}},[a("el-button",{attrs:{type:"text",title:"添加用户",icon:"el-icon-plus"},on:{click:function(a){return e.addTbUser(t,s)}}})],1)])}),1)],1),a("el-row",e._l(e.tbUserList,function(t,s){return a("el-col",{key:t.id,staticClass:"d-hover-btn",attrs:{span:6}},[a("span",[e._v(e._s(t.userNameCn)+"("+e._s(t.userName)+")")]),a("el-button",{attrs:{type:"text",title:"删除用户",icon:"el-icon-delete"},on:{click:function(a){return e.deleteTbUserById(t.id,s)}}})],1)}),1)],1)],1)},r=[],n=(a("20d6"),a("8a52")),i=a("1fc3"),l=a("f958"),o={name:"DMyTbManage",data:function(){return{isMy:!0,searchForm:{dbId:"",tbName:""},pageNo:1,pageSize:10,tableData:{},allDbList:[],currentTb:{},grantUserFormVisible:!1,tbUserList:[],searchUserList:[],userNameList:[]}},methods:{clickTab:function(e){this.isMy=e},setAllDbList:function(){var e=this;Object(i["c"])().then(function(t){e.allDbList=t.data}).catch(this.$handleError)},setTableData:function(){var e=this;Object(n["e"])({dbId:this.searchForm.dbId,tbName:this.searchForm.tbName,pageNo:this.pageNo,pageSize:this.pageSize}).then(function(t){e.tableData=t.data}).catch(this.$handleError)},openGrantUserForm:function(e){this.grantUserFormVisible=!0,this.currentTb=e,this.setTbUserList()},setTbUserList:function(){var e=this;Object(n["h"])({id:this.currentTb.id}).then(function(t){e.tbUserList=t.data}).catch(this.$handleError)},searchUser:function(e){var t=this;e&&Object(l["g"])({keyword:e}).then(function(e){t.searchUserList=e.data.filter(function(e){var a=t.tbUserList.findIndex(function(t){return t.userName===e.userName});return-1===a})}).catch(this.$handleError)},addTbUser:function(e,t){var a=this;Object(n["b"])({tbId:this.currentTb.id,userName:e.userName,userNameCn:e.userNameCn}).then(function(s){a.tbUserList.unshift({id:s.data,userName:e.userName,userNameCn:e.userNameCn}),a.searchUserList.splice(t,1)}).catch(this.$handleError)},deleteTbUserById:function(e,t){var a=this;Object(n["c"])({tbUserId:e}).then(function(e){a.tbUserList.splice(t,1)}).catch(this.$handleError)},selectUser:function(){this.userNameList=[]}},mounted:function(){this.setAllDbList(),this.setTableData()}},c=o,u=a("2877"),b=Object(u["a"])(c,s,r,!1,null,null,null);t["default"]=b.exports}}]);
//# sourceMappingURL=chunk-2d228eef.3c04e341.js.map