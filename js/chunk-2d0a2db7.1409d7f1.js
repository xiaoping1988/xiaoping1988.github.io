(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0a2db7"],{"0067":function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("DPageContent",[a("el-row",{staticClass:"d-row"},[a("el-col",[a("el-card",{attrs:{shadow:"never"}},[a("div",{attrs:{slot:"header"},slot:"header"},[a("span",{staticClass:"d-card-title"},[t._v("项目:    ")]),a("el-select",{staticStyle:{width:"180px"},attrs:{size:"small"},on:{change:t.changeProj},model:{value:t.proj.selectId,callback:function(e){t.$set(t.proj,"selectId",e)},expression:"proj.selectId"}},t._l(t.proj.selectListData,function(t){return a("el-option",{key:t.id,attrs:{value:t.id,label:t.name}})}),1),a("div",{staticStyle:{float:"right"}},[a("el-button",{staticClass:"d-card-btn",attrs:{type:"text"},on:{click:t.openAddProjForm}},[t._v("\n                            创建新项目\n                        ")]),t.proj.selectId?a("el-button",{staticClass:"d-card-btn",attrs:{type:"text"},on:{click:t.openUpdateProjForm}},[t._v("\n                            编辑项目\n                        ")]):t._e(),t.proj.selectId?a("el-button",{staticClass:"d-card-btn",attrs:{type:"text"},on:{click:t.deleteProjById}},[t._v("\n                            删除项目\n                        ")]):t._e()],1)],1),a("DDetail",{attrs:{data:t.proj.detailData,columns:t.proj.detailColumns}}),a("el-dialog",{attrs:{title:t.proj.formTitle,visible:t.proj.formVisible},on:{"update:visible":function(e){return t.$set(t.proj,"formVisible",e)}}},[a("el-form",{ref:"projForm",attrs:{model:t.proj.formData,rules:t.proj.formRules,"label-width":"60px"}},[a("el-form-item",{attrs:{label:"名称",prop:"name"}},[a("el-input",{model:{value:t.proj.formData.name,callback:function(e){t.$set(t.proj.formData,"name","string"===typeof e?e.trim():e)},expression:"proj.formData.name"}})],1),a("el-form-item",{attrs:{label:"编码",prop:"code"}},[a("el-input",{attrs:{placeholder:"字母开头,只能包含字母、数字、下划线"},model:{value:t.proj.formData.code,callback:function(e){t.$set(t.proj.formData,"code","string"===typeof e?e.trim():e)},expression:"proj.formData.code"}})],1)],1),a("DSubmitCancel",{attrs:{slot:"footer",nohr:""},on:{submit:t.submitProjForm,cancel:function(e){t.proj.formVisible=!1}},slot:"footer"})],1)],1)],1)],1),a("el-row",[a("el-col",[a("el-card",{attrs:{shadow:"never"}},[a("el-tabs",{model:{value:t.activeTab,callback:function(e){t.activeTab=e},expression:"activeTab"}},[a("el-tab-pane",{attrs:{label:"功能资源",name:"static"}},[a("StaticResource",{attrs:{projId:t.proj.selectId}})],1),a("el-tab-pane",{attrs:{label:"数据资源大类",name:"data"}},[a("DataResource",{attrs:{projId:t.proj.selectId}})],1),a("el-tab-pane",{attrs:{label:"白名单资源",name:"white"}},[a("WhiteListResource",{attrs:{projId:t.proj.selectId}})],1)],1)],1)],1)],1)],1)},o=[],i=(a("7f7f"),a("2f24")),l=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-row",[a("el-col",{staticStyle:{"border-right":"1px solid #e8e8e8","padding-right":"10px"},attrs:{span:8}},[a("el-button",{staticStyle:{width:"100%","margin-bottom":"10px"},attrs:{size:"small",icon:"el-icon-plus"},on:{click:t.openAddRootStaticResourceForm}},[t._v("创建根资源")]),a("el-tree",{ref:"resourceTree",attrs:{"default-expand-all":"","highlight-current":"","node-key":"id",data:t.treeData},on:{"current-change":t.changeStaticResource}})],1),a("el-col",{staticStyle:{"padding-left":"10px"},attrs:{span:16}},[t.selectId?a("el-card",{attrs:{shadow:"never"}},[a("div",{attrs:{slot:"header"},slot:"header"},[a("span",{staticClass:"d-card-title"},[t._v("资源")]),a("div",{staticStyle:{float:"right"}},[a("el-button",{staticClass:"d-card-btn",attrs:{type:"text"},on:{click:t.openAddChildStaticResourceForm}},[t._v("\n                        添加子资源\n                    ")]),a("el-button",{staticClass:"d-card-btn",attrs:{type:"text"},on:{click:t.openUpdateStaticResourceForm}},[t._v("\n                        编辑\n                    ")]),a("el-button",{staticClass:"d-card-btn",attrs:{type:"text"},on:{click:t.deleteStaticResourceById}},[t._v("\n                        删除\n                    ")])],1)]),a("DDetail",{attrs:{data:t.detailData,columns:t.detailColumns,col:4}}),a("div",{staticClass:"d-desclist-index"},[a("div",{staticClass:"d-desclist-index-term"},[t._v("后端API")]),a("div",{staticClass:"d-desclist-index-detail"},t._l(t.detailData.beApiList,function(e){return a("div",{key:e.id},[a("span",[t._v(t._s(e.name)+"：")]),a("span",[t._v(t._s(e.url))])])}),0)])],1):t._e()],1),a("el-dialog",{attrs:{title:t.formTitle,visible:t.formVisible},on:{"update:visible":function(e){t.formVisible=e}}},[a("el-form",{ref:"staticResourceForm",attrs:{model:t.formData,rules:t.formRules,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"类型",prop:"type"}},[a("el-radio-group",{model:{value:t.formData.type,callback:function(e){t.$set(t.formData,"type",e)},expression:"formData.type"}},[a("el-radio",{attrs:{label:"MENU"}},[t._v("MENU")]),a("el-radio",{attrs:{label:"BUTTON"}},[t._v("BUTTON")])],1)],1),a("el-form-item",{attrs:{label:"名称",prop:"name"}},[a("el-input",{model:{value:t.formData.name,callback:function(e){t.$set(t.formData,"name","string"===typeof e?e.trim():e)},expression:"formData.name"}})],1),a("el-form-item",{attrs:{label:"编码",prop:"code"}},[a("el-input",{attrs:{placeholder:"字母开头,只能包含字母、数字、下划线"},model:{value:t.formData.code,callback:function(e){t.$set(t.formData,"code","string"===typeof e?e.trim():e)},expression:"formData.code"}})],1),a("el-form-item",{attrs:{label:"前端路由",prop:"feRouter"}},[a("el-input",{model:{value:t.formData.feRouter,callback:function(e){t.$set(t.formData,"feRouter","string"===typeof e?e.trim():e)},expression:"formData.feRouter"}})],1),a("el-form-item",{attrs:{label:"后端API"}},[t._l(t.formData.beApiList,function(e,r){return a("el-row",{key:r},[a("el-col",{attrs:{span:10}},[a("el-form-item",{staticStyle:{"margin-bottom":"22px"},attrs:{"label-width":"0px",prop:"beApiList."+r+".name",rules:[{required:!0,message:"接口名称不能为空",trigger:"blur"}]}},[a("el-input",{attrs:{placeholder:"接口名称"},model:{value:e.name,callback:function(a){t.$set(e,"name","string"===typeof a?a.trim():a)},expression:"api.name"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{staticStyle:{"margin-bottom":"22px"},attrs:{"label-width":"0px",prop:"beApiList."+r+".url",rules:[{required:!0,message:"接口路径不能为空",trigger:"blur"}]}},[a("el-input",{attrs:{placeholder:"接口路径"},model:{value:e.url,callback:function(a){t.$set(e,"url","string"===typeof a?a.trim():a)},expression:"api.url"}})],1)],1),a("el-col",{attrs:{span:2}},[a("el-button",{attrs:{size:"medium",icon:"el-icon-minus"},on:{click:function(e){return t.deleteStaticResourceApi(r)}}})],1)],1)}),a("el-row",[a("el-col",[a("el-button",{attrs:{size:"medium",type:"primary",icon:"el-icon-plus"},on:{click:t.addStaticResourceApi}})],1)],1)],2)],1),a("DSubmitCancel",{attrs:{slot:"footer",nohr:""},on:{submit:t.submitStaticResourceForm,cancel:function(e){t.formVisible=!1}},slot:"footer"})],1)],1)},s=[],n=(a("c5f6"),a("bc3b")),c={name:"StaticResource",props:{projId:Number},data:function(){return{treeData:[],selectId:0,detailData:{},detailColumns:[{key:"name",title:"名称"},{key:"code",title:"编码"},{key:"type",title:"类型"},{key:"feRouter",title:"前端路由"}],formVisible:!1,formTitle:"",formData:{name:"",code:"",feRouter:"",type:"MENU",pid:0,beApiList:[]},formRules:{name:[{required:!0,message:"请输入名称",trigger:"blur"}],code:[{type:"string",pattern:/^[A-Za-z]+[A-Za-z0-9_]*[A-Za-z0-9]+$/,message:"字母开头,只能包含字母、数字、下划线",trigger:"blur"}]}}},methods:{setStaticResourceTreeData:function(t){var e=this;if(!e.projId)return e.treeData=[],e.selectId=null,void(e.detailData={});Object(n["g"])({projId:e.projId}).then(function(a){e.treeData=a.data,e.treeData&&e.treeData.length?(e.selectId=t||e.treeData[0].id,e.setStaticResourceDetail()):(e.selectId=null,e.detailData={}),e.$nextTick(function(){e.$refs.resourceTree.setCurrentKey(e.selectId)})}).catch(this.$handleError)},setStaticResourceDetail:function(){var t=this;Object(n["e"])({id:this.selectId}).then(function(e){t.detailData=e.data}).catch(this.$handleError)},changeStaticResource:function(t,e){this.selectId=t.id,this.setStaticResourceDetail()},openAddRootStaticResourceForm:function(){this.formData={pid:0,name:"",code:"",type:"MENU",feRouter:"",beApiList:[]},this.formTitle="创建根资源",this.formVisible=!0},openAddChildStaticResourceForm:function(){this.formData={pid:this.selectId,name:"",code:"",type:"MENU",feRouter:"",beApiList:[]},this.formTitle="添加子资源",this.formVisible=!0},openUpdateStaticResourceForm:function(){this.formData={id:this.detailData.id,pid:this.detailData.pid,name:this.detailData.name,code:this.detailData.code,type:this.detailData.type,feRouter:this.detailData.feRouter,beApiList:this.detailData.beApiList},this.formTitle="编辑资源",this.formVisible=!0},addStaticResourceApi:function(){this.formData.beApiList.push({name:"",url:""})},deleteStaticResourceApi:function(t){this.formData.beApiList.splice(t,1)},submitStaticResourceForm:function(){var t=this;this.$refs["staticResourceForm"].validate(function(e){if(!e)return!1;Object(n["j"])({projId:t.projId,id:t.formData.id,pid:t.formData.pid,name:t.formData.name,code:t.formData.code,type:t.formData.type,feRouter:t.formData.feRouter,beApiList:JSON.stringify(t.formData.beApiList)}).then(function(e){t.formVisible=!1,t.formData.id?t.setStaticResourceDetail():t.setStaticResourceTreeData(e.data)}).catch(t.$handleError)})},deleteStaticResourceById:function(){var t='确认删除资源<strong class="d-error">"'+this.detailData.name+'"</strong>吗?',e=this;e.$confirmInfo(t,function(){Object(n["c"])({id:e.selectId}).then(function(t){e.setStaticResourceTreeData()}).catch(e.$handleError)})}},watch:{projId:function(){this.setStaticResourceTreeData()}}},d=c,m=a("2877"),u=Object(m["a"])(d,l,s,!1,null,null,null),f=u.exports,p=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-plus"},on:{click:t.openAddForm}},[t._v("新增")]),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData}},[a("el-table-column",{attrs:{prop:"name",label:"名称",width:"220"}}),a("el-table-column",{attrs:{prop:"code",label:"编码",width:"220"}}),a("el-table-column",{attrs:{prop:"url",label:"数据接口"}}),a("el-table-column",{attrs:{label:"操作",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return t.openUpdateForm(e.row)}}},[t._v("编辑")]),a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return t.deleteDataResourceById(e.row)}}},[t._v("删除")])]}}])})],1),a("el-dialog",{attrs:{title:t.formTitle,visible:t.formVisible},on:{"update:visible":function(e){t.formVisible=e}}},[a("el-form",{ref:"dataResourceForm",attrs:{model:t.formData,rules:t.formRules,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"名称",prop:"name"}},[a("el-input",{model:{value:t.formData.name,callback:function(e){t.$set(t.formData,"name","string"===typeof e?e.trim():e)},expression:"formData.name"}})],1),a("el-form-item",{attrs:{label:"编码",prop:"code"}},[a("el-input",{attrs:{placeholder:"字母开头,只能包含字母、数字、下划线"},model:{value:t.formData.code,callback:function(e){t.$set(t.formData,"code","string"===typeof e?e.trim():e)},expression:"formData.code"}})],1),a("el-form-item",{attrs:{label:"数据接口",prop:"url"}},[a("el-input",{model:{value:t.formData.url,callback:function(e){t.$set(t.formData,"url","string"===typeof e?e.trim():e)},expression:"formData.url"}})],1)],1),a("DSubmitCancel",{attrs:{slot:"footer",nohr:""},on:{submit:t.submitDataResourceForm,cancel:function(e){t.formVisible=!1}},slot:"footer"})],1)],1)},b=[],h={name:"DataResource",props:{projId:Number},data:function(){return{tableData:[],formVisible:!1,formTitle:"",formData:{name:"",code:"",url:""},formRules:{name:[{required:!0,message:"请输入名称",trigger:"blur"}],code:[{required:!0,message:"请输入编码",trigger:"blur"},{type:"string",pattern:/^[A-Za-z]+[A-Za-z0-9_]*[A-Za-z0-9]+$/,message:"字母开头,只能包含字母、数字、下划线",trigger:"blur"}],url:[{required:!0,message:"请输入数据接口",trigger:"blur"},{type:"url",message:"数据接口不规范",trigger:"blur"}]}}},methods:{setDataResourceTableData:function(){var t=this;this.projId?Object(n["f"])({projId:this.projId}).then(function(e){t.tableData=e.data}).catch(this.$handleError):this.tableData=[]},openAddForm:function(){this.formData={name:"",code:"",url:""},this.formTitle="新增数据资源大类",this.formVisible=!0},openUpdateForm:function(t){this.formData={id:t.id,name:t.name,code:t.code,url:t.url},this.formTitle="编辑数据资源大类",this.formVisible=!0},submitDataResourceForm:function(){var t=this;this.$refs["dataResourceForm"].validate(function(e){if(!e)return!1;Object(n["i"])({projId:t.projId,id:t.formData.id,name:t.formData.name,code:t.formData.code,url:t.formData.url}).then(function(e){t.formVisible=!1,t.setDataResourceTableData()}).catch(t.$handleError)})},deleteDataResourceById:function(t){var e='确认删除数据资源大类<strong class="d-error">"'+t.name+'"</strong>吗?',a=this;a.$confirmInfo(e,function(){Object(n["b"])({id:t.id}).then(function(t){a.setDataResourceTableData()}).catch(a.$handleError)})}},watch:{projId:function(){this.setDataResourceTableData()}}},D=h,j=Object(m["a"])(D,p,b,!1,null,null,null),g=j.exports,y=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-plus"},on:{click:t.openAddForm}},[t._v("新增")]),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData}},[a("el-table-column",{attrs:{prop:"typeName",width:"220",label:"类型"}}),a("el-table-column",{attrs:{prop:"name",label:"名称",width:"220"}}),a("el-table-column",{attrs:{prop:"url",label:"URL"}}),a("el-table-column",{attrs:{label:"操作",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return t.openUpdateForm(e.row)}}},[t._v("编辑")]),a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return t.deleteById(e.row)}}},[t._v("删除")])]}}])})],1),a("el-dialog",{attrs:{title:t.formTitle,visible:t.formVisible},on:{"update:visible":function(e){t.formVisible=e}}},[a("el-form",{ref:"formData",attrs:{model:t.formData,rules:t.formRules,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"类型",prop:"type"}},[a("el-radio-group",{model:{value:t.formData.type,callback:function(e){t.$set(t.formData,"type",e)},expression:"formData.type"}},[a("el-radio",{attrs:{label:1}},[t._v("后端")]),a("el-radio",{attrs:{label:2}},[t._v("前端")])],1)],1),a("el-form-item",{attrs:{label:"名称",prop:"name"}},[a("el-input",{model:{value:t.formData.name,callback:function(e){t.$set(t.formData,"name","string"===typeof e?e.trim():e)},expression:"formData.name"}})],1),a("el-form-item",{attrs:{label:"URL",prop:"url"}},[a("el-input",{model:{value:t.formData.url,callback:function(e){t.$set(t.formData,"url","string"===typeof e?e.trim():e)},expression:"formData.url"}})],1)],1),a("DSubmitCancel",{attrs:{slot:"footer",nohr:""},on:{submit:t.submitForm,cancel:function(e){t.formVisible=!1}},slot:"footer"})],1)],1)},v=[],R={name:"WhiteListResource",props:{projId:Number},data:function(){return{tableData:[],formVisible:!1,formTitle:"",formData:{name:"",type:1,url:""},formRules:{name:[{required:!0,message:"请输入名称",trigger:"blur"}],url:[{required:!0,message:"请输入URL",trigger:"blur"}]}}},methods:{setTableData:function(){var t=this;this.projId?Object(n["h"])({projId:this.projId}).then(function(e){t.tableData=e.data}).catch(this.$handleError):this.tableData=[]},openAddForm:function(){this.formData={name:"",type:1,url:""},this.formTitle="新增白名单",this.formVisible=!0},openUpdateForm:function(t){this.formData={id:t.id,name:t.name,type:t.type,url:t.url},this.formTitle="编辑白名单",this.formVisible=!0},submitForm:function(){var t=this;this.$refs["formData"].validate(function(e){if(!e)return!1;Object(n["k"])({projId:t.projId,id:t.formData.id,name:t.formData.name,type:t.formData.type,url:t.formData.url}).then(function(e){t.formVisible=!1,t.setTableData()}).catch(t.$handleError)})},deleteById:function(t){var e='确认删除白名单资源<strong class="d-error">"'+t.name+'"</strong>吗?',a=this;a.$confirmInfo(e,function(){Object(n["d"])({id:t.id}).then(function(t){a.setTableData()}).catch(a.$handleError)})}},watch:{projId:function(){this.setTableData()}}},I=R,k=Object(m["a"])(I,y,v,!1,null,null,null),x=k.exports,S={name:"Resource",components:{StaticResource:f,DataResource:g,WhiteListResource:x},data:function(){return{proj:{selectListData:[],selectId:0,detailData:{},detailColumns:[{key:"name",title:"名称"},{key:"creator",title:"创建人"},{key:"updator",title:"修改人"},{key:"code",title:"编码"},{key:"createTime",title:"创建时间"},{key:"updateTime",title:"修改时间"}],formVisible:!1,formTitle:"新建项目",formData:{name:"",code:""},formRules:{name:[{required:!0,message:"请输入名称",trigger:"blur"}],code:[{required:!0,message:"请输入编码",trigger:"blur"},{type:"string",pattern:/^[A-Za-z]+[A-Za-z0-9_]*[A-Za-z0-9]+$/,message:"字母开头,只能包含字母、数字、下划线",trigger:"blur"}]}},activeTab:"static"}},methods:{setProjSelectListData:function(){var t=this;Object(i["d"])().then(function(e){t.proj.selectListData=e.data,t.proj.selectListData&&t.proj.selectListData.length?(t.proj.selectId=t.proj.selectListData[0].id,t.changeProj()):(t.proj.selectId=null,t.proj.detailData={})}).catch(this.$handleError)},changeProj:function(){this.setProjDetail()},setProjDetail:function(){var t=this;Object(i["c"])({id:this.proj.selectId}).then(function(e){t.proj.detailData=e.data}).catch(this.$handleError)},openAddProjForm:function(){this.proj.formTitle="创建新项目",this.proj.formVisible=!0,this.proj.formData={name:"",code:""}},openUpdateProjForm:function(){this.proj.formTitle="编辑项目",this.proj.formVisible=!0,this.proj.formData={id:this.proj.detailData.id,name:this.proj.detailData.name,code:this.proj.detailData.code}},submitProjForm:function(){var t=this;this.$refs["projForm"].validate(function(e){if(!e)return!1;Object(i["e"])(t.proj.formData).then(function(e){t.proj.formVisible=!1,t.proj.formData.id?t.setProjDetail():t.setProjSelectListData()}).catch(t.$handleError)})},deleteProjById:function(){var t='确认删除项目<strong class="d-error">"'+this.proj.detailData.name+'"</strong>吗?',e=this;e.$confirmInfo(t,function(){Object(i["b"])({id:e.proj.selectId}).then(function(t){e.setProjSelectListData()}).catch(e.$handleError)})}},mounted:function(){this.setProjSelectListData()}},$=S,_=Object(m["a"])($,r,o,!1,null,null,null);e["default"]=_.exports}}]);
//# sourceMappingURL=chunk-2d0a2db7.1409d7f1.js.map