(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-17832210"],{"03fb":function(t,i,e){},"0876":function(t,i,e){"use strict";var a=function(){var t=this,i=t.$createElement,e=t._self._c||i;return t.previewData?e("div",[e("div",{staticClass:"head"},[t._v("\n        显示最新\n        "),e("span",{staticClass:"d-strong-count"},[t._v(t._s(t.previewData.data.length))]),t._v("\n        条数据,数据最后更新时间\n        "),e("span",{staticClass:"d-strong-count"},[t._v(t._s(t.previewData.lastDataModifiedTime))])]),e("el-table",{attrs:{data:t.previewData.data,height:"400",width:"100%"}},t._l(t.previewData.colList,function(i){return e("el-table-column",{key:i.colName,attrs:{prop:i.colName,label:i.colLabel,width:i.width},scopedSlots:t._u([{key:"header",fn:function(i){return[e("i",{staticClass:"d-icon fa",class:"fa-"+t.dataTypeObj[t.colObj[i.column.property].dataType].icon}),e("span",[t._v(t._s(i.column.label))])]}}],null,!0)})}),1),e("DLoading",{attrs:{loading:t.loading}})],1):t._e()},s=[],n=(e("ac6a"),e("c5f6"),e("8a52")),o=e("76bd"),l=(e("0b85"),{name:"DPreviewTable",props:{tbId:[String,Number]},data:function(){return{dataTypeObj:o["b"],previewData:null,colObj:{},maxColWidth:250,minColWidth:150}},methods:{preview:function(){var t=this;this.previewData||(this.loading=!1,Object(n["i"])({id:this.tbId}).then(function(i){t.previewData=i.data,t.previewData.colList.forEach(function(i){t.colObj[i.colName]=i}),t.loading=!1}).catch(this.$handleError))}},mounted:function(){this.preview()}}),c=l,r=e("2877"),d=Object(r["a"])(c,a,s,!1,null,null,null);i["a"]=d.exports},1729:function(t,i,e){"use strict";e.r(i);var a=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"d-chart-design"},[e("div",{staticClass:"head"},[t._m(0),e("div",{staticClass:"form-btn"},[e("DSubmitCancel",{attrs:{nohr:"",size:"mini"},on:{submit:t.submit,cancel:t.cancel}})],1)]),e("div",{staticClass:"panel"},[e("div",{staticClass:"d-chart-design-left"},[e("DWorkTable",{attrs:{tbId:t.tbId}})],1),e("div",{staticClass:"d-chart-design-main"},[e("DDimModule"),e("div",{staticClass:"d-chart-index"}),e("div")],1),t._m(1)])])},s=[function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"title"},[e("h2",[t._v("设计图表")])])},function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"d-chart-design-right"},[e("div",{staticClass:"module-title"},[t._v("\n                图表名称\n            ")]),e("div",{staticClass:"module-title"},[t._v("\n                图表类型\n            ")]),e("div",{staticClass:"module-title"},[t._v("\n                图内筛选\n            ")]),e("div",{staticClass:"module-title"},[t._v("\n                图表备注\n            ")])])}],n=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"d-work-table"},[e("div",{staticClass:"table"},[e("div",{staticClass:"module-title"},[t._v("\n            工作表\n        ")]),e("div",{staticClass:"table-name-panel"},[e("div",{staticClass:"table-name d-ellipsis",attrs:{title:t.tbInfo.tbNameCn},on:{click:t.openPreviewTable}},[t._v(t._s(t.tbInfo.tbNameCn))]),e("div",{staticClass:"exchange-table",attrs:{title:"切换工作表"},on:{click:t.openExchangeTable}},[e("i",{staticClass:"fa fa-exchange"})])])]),e("div",{staticClass:"column"},[t._m(0),e("div",{staticClass:"search"},[e("el-input",{staticClass:"d-visual-input",attrs:{size:"mini",clearable:"",placeholder:"搜索字段","suffix-icon":"el-icon-search"},model:{value:t.colKeyword,callback:function(i){t.colKeyword="string"===typeof i?i.trim():i},expression:"colKeyword"}})],1),e("ul",{staticClass:"col-list"},t._l(t.searchedColList,function(i){return e("li",{key:i.colName},[e("div",{staticClass:"col-item",attrs:{title:i.colName,draggable:"true"},on:{click:function(e){return t.toggleShowTimeFreq(i)}}},[e("div",{staticClass:"pre-icon"},[e("i",{staticClass:"fa",class:"fa-"+t.dataTypeObj[i.dataType].icon})]),e("div",{staticClass:"col-label d-ellipsis"},[t._v("\n                        "+t._s(i.colLabel)+"\n                    ")])])])}),0)]),e("DLoading",{attrs:{loading:t.loading}}),e("el-dialog",{attrs:{visible:t.showPreviewModal,title:"预览数据",top:"30px",width:"70%"},on:{"update:visible":function(i){t.showPreviewModal=i}}},[t.showPreviewed?e("DPreviewTable",{attrs:{tbId:t.tbId}}):t._e()],1),e("el-dialog",{attrs:{visible:t.showExchangeModal,title:"切换工作表",top:"30px",width:"360px"},on:{"update:visible":function(i){t.showExchangeModal=i}}},[t.showExchanged?e("DWorkTableSelect",{on:{select:t.exchangeTable}}):t._e()],1)],1)},o=[function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"head"},[e("div",{staticClass:"module-title"},[t._v("\n                字段\n            ")]),e("div",{staticClass:"col-btn"},[e("i",{staticClass:"el-icon-plus"}),e("ul",{staticClass:"d-btn-list"},[e("li",[t._v("添加计算字段")])])])])}],l=(e("6762"),e("2fdb"),e("ac6a"),e("8615"),e("c5f6"),e("8a52")),c=e("76bd"),r=e("0876"),d=e("d45b"),m=e("6f7f"),u={name:"DWorkTable",components:{DPreviewTable:r["a"],DWorkTableSelect:d["a"]},props:{tbId:[String,Number]},data:function(){return{loading:!1,timeFreqList:Object.values(m["i"]),dataTypeObj:c["b"],showPreviewModal:!1,showPreviewed:!1,showExchangeModal:!1,showExchanged:!1,tbInfo:{},logicColList:[],searchedColList:[],searchedLogicColList:[],colKeyword:""}},methods:{initData:function(){this.setTbInfo(),this.setTbLogicCol()},setTbInfo:function(){var t=this;this.loading=!0,Object(l["d"])({id:this.tbId}).then(function(i){t.tbInfo=i.data,t.loading=!1,t.searchColList()}).catch(this.$handleError)},setTbLogicCol:function(){},searchColList:function(){var t=this;""===this.colKeyword?this.searchedColList=this.tbInfo.colList:this.searchedColList=this.tbInfo.colList.filter(function(i){return i.colName.includes(t.colKeyword.toLowerCase())||i.colLabel.includes(t.colKeyword)})},searchLogicColList:function(){},openPreviewTable:function(){this.showPreviewModal=!0,this.showPreviewed=!0},openExchangeTable:function(){this.showExchangeModal=!0,this.showExchanged=!0},exchangeTable:function(t){this.showExchangeModal=!1,this.tbId=t.id},toggleShowTimeFreq:function(t){t.dataType===c["b"].date.code&&(t.showTimeFreq=!t.showTimeFreq,this.$forceUpdate())}},watch:{tbId:function(){this.tbId&&this.initData()},colKeyword:function(){this.searchColList(),this.searchLogicColList()}}},f=u,h=(e("c82b"),e("2877")),b=Object(h["a"])(f,n,o,!1,null,null,null),v=b.exports,C=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"d-chart-dim"},[e("div",{staticClass:"d-dim-container"},[t._m(0),e("ul",{staticClass:"drag-container"},t._l(t.dimList,function(i,a){return e("li",{key:a,staticClass:"drag-item"},[e("div",{staticClass:"tag-item",on:{click:function(e){return t.openConfig(i)}}},[e("div",[e("span",[t._v(t._s(i.dimConfig.showName))]),i.dimConfig.timeFreq?e("span",[t._v("(按"+t._s(t.timeFreqObj[i.dimConfig.timeFreq].name)+")")]):t._e()]),e("div",{staticClass:"btn"},[e("i",{staticClass:"fa fa-times-circle",attrs:{title:"移除字段"},on:{click:function(i){return t.removeDim(a)}}})])])])}),0),t.hasContrast?t._e():e("div",{staticClass:"right-btn",on:{click:t.addContrast}},[e("span",[t._v("添加对比")])])]),t.hasContrast?e("div",{staticClass:"d-dim-container"},[e("div",{staticClass:"label"},[t._v("对比")]),e("ul",{staticClass:"drag-container"}),e("div",{staticClass:"right-btn",on:{click:t.removeContrast}},[e("span",[t._v("移除对比")])])]):t._e(),e("el-dialog",{attrs:{visible:t.configModalVisible,"close-on-click-modal":!1,"close-on-press-escape":!1,width:"400px"},on:{"update:visible":function(i){t.configModalVisible=i}}},[e("div",{attrs:{slot:"title"},slot:"title"},[e("span",[e("span",{staticStyle:{color:"#1c2438","font-weight":"700"}},[t._v("维度配置:")]),e("span",{staticStyle:{color:"#be3330"}},[t._v(t._s(t.currentConfigDim.dimConfig.showName))]),e("span",{staticStyle:{color:"#1c2438","font-weight":"700","margin-left":"10px"}},[t._v("原始名称:")]),e("span",{staticStyle:{color:"#be3330"}},[t._v(t._s(t.currentConfigDim.colLabel))])])]),e("el-tabs",{model:{value:t.activeConfigTab,callback:function(i){t.activeConfigTab=i},expression:"activeConfigTab"}},[t.currentConfigDim.dimConfig.timeFreq?e("el-tab-pane",{attrs:{label:"粒度",name:"tf"}},[e("el-radio-group",{model:{value:t.configForm.timeFreq,callback:function(i){t.$set(t.configForm,"timeFreq",i)},expression:"configForm.timeFreq"}},t._l(t.timeFreqList,function(i){return e("div",{key:i.code,staticClass:"vertical"},[e("el-radio",{attrs:{label:i.code}},[t._v("按"+t._s(i.name))])],1)}),0)],1):t._e(),e("el-tab-pane",{attrs:{label:"字段设置",name:"bs"}},[e("el-row",{staticClass:"d-row d-form-item"},[e("div",{staticClass:"dim-bs-form-label"},[e("span",[t._v("字段别名")])]),e("div",{staticClass:"dim-bs-form-input"},[e("el-input",{attrs:{size:"mini"},model:{value:t.configForm.showName,callback:function(i){t.$set(t.configForm,"showName",i)},expression:"configForm.showName"}})],1)]),e("el-row",{staticClass:"d-row d-form-item"},[e("div",{staticClass:"dim-bs-form-label"},[e("span",[t._v("排序方式")])]),e("div",{staticClass:"dim-bs-form-input"},[e("el-select",{staticStyle:{width:"100%"},attrs:{size:"mini"},model:{value:t.configForm.sortType,callback:function(i){t.$set(t.configForm,"sortType",i)},expression:"configForm.sortType"}},[e("el-option",{attrs:{value:"0",label:"默认"}}),e("el-option",{attrs:{value:"asc",label:"正序"}}),e("el-option",{attrs:{value:"desc",label:"倒序"}})],1)],1)])],1)],1),e("DSubmitCancel",{attrs:{slot:"footer",nohr:"",size:"mini",submitText:"确定"},on:{submit:t.submitConfigForm,cancel:function(i){t.configModalVisible=!1}},slot:"footer"})],1)],1)},g=[function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"label"},[e("span",[t._v("维度")]),e("i",{staticClass:"fa fa-pencil",attrs:{title:"批量添加"}})])}],p={name:"DDimModule",data:function(){return{timeFreqObj:m["i"],timeFreqList:Object.values(m["i"]),dimList:[{colLabel:"xxx",dimConfig:{key:"col_1",showName:"订单类型",timeFreq:"",sortType:"0"}},{colLabel:"yyy",dimConfig:{key:"col_1",showName:"日期",timeFreq:m["i"].day.code,sortType:"0"}}],hasContrast:!1,contrastDimList:[],configModalVisible:!1,configForm:{timeFreq:"",showName:"",sortType:""},currentConfigDim:{colLabel:"",dimConfig:{key:"",showName:"",sortType:""}},activeConfigTab:""}},methods:{addContrast:function(){this.hasContrast=!0},removeContrast:function(){this.hasContrast=!1,this.contrastDimList=[]},removeDim:function(t){this.dimList.splice(t,1)},openConfig:function(t){this.currentConfigDim=t,this.configForm={timeFreq:t.dimConfig.timeFreq,showName:t.dimConfig.showName,sortType:t.dimConfig.sortType},t.dimConfig.timeFreq?this.activeConfigTab="tf":this.activeConfigTab="bs",this.configModalVisible=!0},submitConfigForm:function(){this.currentConfigDim.dimConfig.timeFreq=this.configForm.timeFreq,this.currentConfigDim.dimConfig.sortType=this.configForm.sortType,this.configForm.showName?this.currentConfigDim.dimConfig.showName=this.configForm.showName:this.currentConfigDim.dimConfig.showName=this.currentConfigDim.colLabel,this.configModalVisible=!1}}},w=p,_=(e("2242"),Object(h["a"])(w,C,g,!1,null,null,null)),T=_.exports,y={name:"DChartDesign",components:{DWorkTable:v,DDimModule:T},data:function(){return{tbId:""}},methods:{submit:function(){},cancel:function(){this.$goBack()}},mounted:function(){this.tbId=this.$route.query.tbId}},D=y,L=(e("e225"),Object(h["a"])(D,a,s,!1,null,null,null));i["default"]=L.exports},2242:function(t,i,e){"use strict";var a=e("4618"),s=e.n(a);s.a},"42bb":function(t,i,e){"use strict";var a=e("49fe"),s=e.n(a);s.a},4618:function(t,i,e){},"49fe":function(t,i,e){},c82b:function(t,i,e){"use strict";var a=e("f338"),s=e.n(a);s.a},d45b:function(t,i,e){"use strict";var a=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",[e("el-row",{staticClass:"d-row"},[t._v("\n        选择工作表\n    ")]),e("el-row",{staticClass:"d-row"},[e("el-input",{attrs:{size:"mini",clearable:"",placeholder:"搜索工作表","suffix-icon":"el-icon-search"},on:{change:t.searchTable},model:{value:t.tableKeyWord,callback:function(i){t.tableKeyWord="string"===typeof i?i.trim():i},expression:"tableKeyWord"}})],1),e("el-row",{staticClass:"d-row"},[e("div",{staticClass:"d-tb-panel"},[e("ul",{staticClass:"d-tb-list"},t._l(t.searchedTableList,function(i,a){return e("li",{key:a,staticClass:"d-tb-item",on:{click:function(e){return t.selectTable(i)}}},[e("h4",{staticClass:"d-tb-title d-ellipsis",attrs:{title:i.dbName+"."+i.tbName}},[t._v(t._s(i.dbName)+"."+t._s(i.tbName))]),e("div",{staticClass:"d-tb-desc d-ellipsis",attrs:{title:i.tbNameCn}},[t._v(t._s(i.tbNameCn))])])}),0)])])],1)},s=[],n=e("8a52"),o={name:"DWorkTableSelect",data:function(){return{tableKeyWord:"",searchedTableList:[]}},methods:{searchTable:function(){var t=this;Object(n["f"])({tbName:this.tableKeyWord,pageNo:1,pageSize:15}).then(function(i){t.searchedTableList=i.data.data}).catch(this.$handleError)},selectTable:function(t){this.$emit("select",t)}},mounted:function(){this.searchTable()}},l=o,c=(e("42bb"),e("2877")),r=Object(c["a"])(l,a,s,!1,null,null,null);i["a"]=r.exports},e225:function(t,i,e){"use strict";var a=e("03fb"),s=e.n(a);s.a},f338:function(t,i,e){}}]);
//# sourceMappingURL=chunk-17832210.e152f80e.js.map