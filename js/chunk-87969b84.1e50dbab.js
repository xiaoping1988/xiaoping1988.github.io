(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-87969b84"],{"3b1c":function(t,s,e){"use strict";var a=e("b179"),i=e.n(a);i.a},"5c9f":function(t,s,e){"use strict";e.r(s);var a=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"d-dashboard"},[e("div",{staticClass:"d-dash-side"},[e("div",{staticClass:"d-dash-menu-head"},[e("div",{staticClass:"d-dash-search"},[e("el-input",{staticClass:"d-visual-input",attrs:{size:"mini",clearable:"",placeholder:"搜索仪表盘/图表","suffix-icon":"el-icon-search"},model:{value:t.keyword,callback:function(s){t.keyword="string"===typeof s?s.trim():s},expression:"keyword"}}),e("div",{directives:[{name:"show",rawName:"v-show",value:t.keyword,expression:"keyword"}],staticClass:"d-dash-search-result d-btn-list"},[t.searchResult.chartList.length?e("div",{staticClass:"d-dash-search-result-type"},[e("div",{staticClass:"head"},[e("span",{staticClass:"type"},[t._v("图表")]),e("span",{staticClass:"count"},[t._v(t._s(t.searchResult.chartList.length))])]),e("ul",{staticClass:"d-dash-search-result-list"},t._l(t.searchResult.chartList,function(s){return e("li",{key:s.id,on:{click:function(e){return t.clickSearchedChart(s)}}},[e("p",{staticClass:"title d-ellipsis",attrs:{title:s.name}},[t._v(t._s(s.name))]),e("p",{staticClass:"sub d-ellipsis",attrs:{title:s.dash.name+"/"+s.proj.name}},[t._v(t._s(s.dash.name)+"/"+t._s(s.proj.name))])])}),0)]):t._e(),t.searchResult.dashList.length?e("div",{staticClass:"d-dash-search-result-type"},[e("div",{staticClass:"head"},[e("span",{staticClass:"type"},[t._v("仪表盘")]),e("span",{staticClass:"count"},[t._v(t._s(t.searchResult.dashList.length))])]),e("ul",{staticClass:"d-dash-search-result-list"},t._l(t.searchResult.dashList,function(s){return e("li",{key:s.id,on:{click:function(e){return t.clickSearchedDash(s)}}},[e("p",{staticClass:"title d-ellipsis",attrs:{title:s.name}},[t._v(t._s(s.name))]),e("p",{staticClass:"sub d-ellipsis",attrs:{title:s.proj.name}},[t._v(t._s(s.proj.name))])])}),0)]):t._e(),t.searchResult.projList.length?e("div",{staticClass:"d-dash-search-result-type"},[e("div",{staticClass:"head"},[e("span",{staticClass:"type"},[t._v("文件夹")]),e("span",{staticClass:"count"},[t._v(t._s(t.searchResult.projList.length))])]),e("ul",{staticClass:"d-dash-search-result-list"},t._l(t.searchResult.projList,function(s){return e("li",{key:s.id,on:{click:function(e){return t.clickSearchedProj(s)}}},[e("p",{staticClass:"title d-ellipsis",attrs:{title:s.name}},[t._v(t._s(s.name))])])}),0)]):t._e(),t.searchResult.chartList.length||t.searchResult.dashList.length||t.searchResult.projList.length?t._e():e("div",{staticClass:"d-no-data-tip"},[t._v("\n                        没有找到图表/仪表盘/文件\n                    ")])])],1),e("div",{staticClass:"d-dash-btn"},[e("i",{staticClass:"el-icon-plus",attrs:{title:"创建文件夹/仪表盘"}}),e("ul",{staticClass:"d-dash-head-btn-list d-btn-list"},[e("li",{on:{click:t.openAddProj}},[t._v("创建文件夹")]),e("li",{on:{click:t.openAddDash}},[t._v("创建仪表盘")])])])]),e("ul",{staticClass:"d-dash-menu",attrs:{id:"dashSideMenu"}},t._l(t.projList,function(s){return e("li",{key:s.id,staticClass:"d-project-item",attrs:{id:"proj_"+s.id}},[e("div",{staticClass:"d-project-name"},[e("div",{staticClass:"name d-ellipsis",on:{click:function(e){return t.clickProj(s)},mouseover:function(e){t.hoverProjItem(e,s)}}},[e("i",{staticClass:"fa fa-folder-o"}),e("span",[t._v(t._s(s.name))])]),s.editAuth?e("div",{staticClass:"btn"},[e("i",{staticClass:"fa fa-ellipsis-v"}),e("ul",{staticClass:"d-project-btn-list d-btn-list",attrs:{id:"proj_btn_"+s.id}},[e("li",{on:{click:function(e){return t.openUpdateProj(s)}}},[t._v("编辑文件夹")]),e("li",{on:{click:function(e){return t.openMoveProj(s)}}},[t._v("移动文件夹")]),e("li",{on:{click:function(e){return t.openDeleteProj(s)}}},[t._v("删除文件夹")])])]):t._e(),e("div",{staticClass:"d-project-detail d-btn-list",attrs:{id:"proj_detail_"+s.id}},[e("el-row",{attrs:{gutter:24}},[e("el-col",{staticClass:"d-desclist-index"},[e("h4",[t._v("文件夹")])]),e("el-col",{staticClass:"d-desclist-index"},[e("div",{staticClass:"d-desclist-index-term"},[t._v("名称")]),e("div",{staticClass:"d-desclist-index-detail"},[t._v(t._s(s.name))])]),e("el-col",{staticClass:"d-desclist-index"},[e("div",{staticClass:"d-desclist-index-term"},[t._v("标签")]),e("div",{staticClass:"d-desclist-index-detail d-tag-group"},t._l(s.tagList,function(s){return e("el-tag",{key:s.id,attrs:{size:"mini"}},[t._v(t._s(s.name))])}),1)]),e("el-col",{staticClass:"d-desclist-index"},[e("div",{staticClass:"d-desclist-index-term"},[t._v("描述")]),e("div",{staticClass:"d-desclist-index-detail"},[t._v(t._s(s.remark))])])],1)],1)]),e("ul",{staticClass:"d-dash-list"},t._l(s.dashList,function(a){return e("li",{key:a.id,staticClass:"d-dash-item",attrs:{id:"dash_"+a.id},on:{click:function(e){return t.clickDash(s,a)}}},[e("div",{staticClass:"name d-ellipsis",on:{mouseover:function(s){t.hoverDashItem(s,a)}}},[e("i",{staticClass:"fa fa-file-image-o"}),e("span",[t._v(t._s(a.name))])]),a.editAuth?e("div",{staticClass:"btn"},[e("i",{staticClass:"fa fa-ellipsis-v"}),e("ul",{staticClass:"d-dash-btn-list d-btn-list",attrs:{id:"dash_btn_"+a.id}},[e("li",{on:{click:function(e){return t.openUpdateDash(s,a)}}},[t._v("编辑仪表盘")]),e("li",{on:{click:function(e){return t.openMoveDash(s,a)}}},[t._v("移动仪表盘")]),e("li",{on:{click:function(e){return t.openCopyDash(s,a)}}},[t._v("复制仪表盘")]),e("li",{on:{click:function(e){return t.openDeleteDash(s,a)}}},[t._v("删除仪表盘")])])]):t._e(),e("div",{staticClass:"d-dash-detail d-btn-list",attrs:{id:"dash_detail_"+a.id}},[e("el-row",{attrs:{gutter:24}},[e("el-col",{staticClass:"d-desclist-index"},[e("h4",[t._v("仪表盘")])]),e("el-col",{staticClass:"d-desclist-index"},[e("div",{staticClass:"d-desclist-index-term"},[t._v("名称")]),e("div",{staticClass:"d-desclist-index-detail"},[t._v(t._s(a.name))])]),e("el-col",{staticClass:"d-desclist-index"},[e("div",{staticClass:"d-desclist-index-term"},[t._v("标签")]),e("div",{staticClass:"d-desclist-index-detail d-tag-group"},t._l(a.tagList,function(s){return e("el-tag",{key:s.id,attrs:{size:"mini"}},[t._v(t._s(s.name))])}),1)]),e("el-col",{staticClass:"d-desclist-index"},[e("div",{staticClass:"d-desclist-index-term"},[t._v("描述")]),e("div",{staticClass:"d-desclist-index-detail"},[t._v(t._s(a.remark))])]),e("el-col",{staticClass:"d-desclist-index"},[e("div",{staticClass:"d-desclist-index-term"},[t._v("负责人")]),e("div",{staticClass:"d-desclist-index-detail"},[t._v(t._s(a.creatorCn)+"("+t._s(a.creator)+")")])]),e("el-col",{staticClass:"d-desclist-index"},[e("div",{staticClass:"d-desclist-index-term"},[t._v("负责部门")]),e("div",{staticClass:"d-desclist-index-detail"},[t._v(t._s(a.departmentName))])])],1)],1)])}),0)])}),0),e("DLoading",{attrs:{loading:t.loading}})],1),e("div",{staticClass:"d-dash-content"},[e("router-view")],1),e("el-dialog",{attrs:{title:t.projFormTitle,visible:t.projFormVisible},on:{"update:visible":function(s){t.projFormVisible=s}}},[e("el-form",{ref:"projForm",attrs:{model:t.projForm,rules:t.projFormRules,"label-width":"50px"}},[e("el-form-item",{attrs:{label:"名称",prop:"name"}},[e("el-input",{model:{value:t.projForm.name,callback:function(s){t.$set(t.projForm,"name","string"===typeof s?s.trim():s)},expression:"projForm.name"}})],1),e("el-form-item",{attrs:{label:"标签"}},[e("div",{staticClass:"d-tag-group"},[t._l(t.projForm.tagList,function(s,a){return e("el-tag",{key:s.id,attrs:{closable:""},on:{close:function(e){return t.handleCloseProjTag(s,a)}}},[t._v(t._s(s.name))])}),t.projTagInputVisible?e("el-input",{staticStyle:{width:"90px"},attrs:{size:"small"},on:{blur:t.handleProjTagInputConfirm},nativeOn:{keyup:function(s){return!s.type.indexOf("key")&&t._k(s.keyCode,"enter",13,s.key,"Enter")?null:t.handleProjTagInputConfirm(s)}},model:{value:t.projTagValue,callback:function(s){t.projTagValue=s},expression:"projTagValue"}}):e("el-button",{attrs:{size:"small",title:"添加标签"},on:{click:t.showProjTagInput}},[t._v("+")])],2)]),e("el-form-item",{attrs:{label:"描述",prop:"remark"}},[e("el-input",{attrs:{type:"textarea",rows:5},model:{value:t.projForm.remark,callback:function(s){t.$set(t.projForm,"remark","string"===typeof s?s.trim():s)},expression:"projForm.remark"}})],1)],1),e("DSubmitCancel",{attrs:{slot:"footer",nohr:""},on:{submit:t.submitProjForm,cancel:function(s){t.projFormVisible=!1}},slot:"footer"})],1),e("el-dialog",{attrs:{title:t.dashFormTitle,visible:t.dashFormVisible},on:{"update:visible":function(s){t.dashFormVisible=s}}},[e("el-form",{ref:"dashForm",attrs:{model:t.dashForm,rules:t.dashFormRules,"label-width":"100px"}},[e("el-form-item",{attrs:{label:"归属文件夹",prop:"projId"}},[e("el-select",{staticStyle:{width:"100%"},attrs:{filterable:""},model:{value:t.dashForm.projId,callback:function(s){t.$set(t.dashForm,"projId",s)},expression:"dashForm.projId"}},t._l(t.projList,function(t){return e("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}),1)],1),e("el-form-item",{attrs:{label:"名称",prop:"name"}},[e("el-input",{model:{value:t.dashForm.name,callback:function(s){t.$set(t.dashForm,"name","string"===typeof s?s.trim():s)},expression:"dashForm.name"}})],1),e("el-form-item",{attrs:{label:"标签"}},[e("div",{staticClass:"d-tag-group"},[t._l(t.dashForm.tagList,function(s,a){return e("el-tag",{key:s.id,attrs:{closable:""},on:{close:function(e){return t.handleCloseDashTag(s,a)}}},[t._v(t._s(s.name))])}),t.dashTagInputVisible?e("el-input",{staticStyle:{width:"90px"},attrs:{size:"small"},on:{blur:t.handleDashTagInputConfirm},nativeOn:{keyup:function(s){return!s.type.indexOf("key")&&t._k(s.keyCode,"enter",13,s.key,"Enter")?null:t.handleDashTagInputConfirm(s)}},model:{value:t.dashTagValue,callback:function(s){t.dashTagValue=s},expression:"dashTagValue"}}):e("el-button",{attrs:{size:"small",title:"添加标签"},on:{click:t.showDashTagInput}},[t._v("+")])],2)]),e("el-form-item",{attrs:{label:"描述",prop:"remark"}},[e("el-input",{attrs:{type:"textarea",rows:5},model:{value:t.dashForm.remark,callback:function(s){t.$set(t.dashForm,"remark","string"===typeof s?s.trim():s)},expression:"dashForm.remark"}})],1)],1),e("DSubmitCancel",{attrs:{slot:"footer",nohr:""},on:{submit:t.submitDashForm,cancel:function(s){t.dashFormVisible=!1}},slot:"footer"})],1)],1)},i=[],r=(e("6762"),e("2fdb"),e("ac6a"),e("c5f6"),e("6b54"),e("7f7f"),e("a777")),o=e("222c"),l={name:"DDashboard",data:function(){return{keyword:"",projList:[],activeProjId:"",activeDashId:"",searchResult:{chartList:[],dashList:[],projList:[]},projFormTitle:"",projFormVisible:!1,projForm:{id:"",name:"",remark:"",tagList:[],delTagIdList:[]},projFormRules:{name:[{required:!0,message:"请输入文件夹名称",trigger:"blur"}]},projTagInputVisible:!1,projTagValue:"",dashFormTitle:"",dashFormVisible:!1,dashForm:{id:"",name:"",remark:"",projId:"",tagList:[],delTagIdList:[]},dashFormRules:{name:[{required:!0,message:"请输入仪表盘名称",trigger:"blur"}],projId:[{required:!0,message:"请选择文件夹归属",trigger:"change"}]},dashTagInputVisible:!1,dashTagValue:"",loading:!1}},methods:{clickProj:function(t){var s=document.getElementById("proj_"+t.id);s.classList.toggle("active");var e=s.querySelector(".d-project-name .name i");e.classList.contains("fa-folder-open-o")?(e.classList.remove("fa-folder-open-o"),e.classList.add("fa-folder-o")):(e.classList.add("fa-folder-open-o"),e.classList.remove("fa-folder-o"))},activeProj:function(t){var s=document.getElementById("proj_"+t.id);if(!s.classList.contains("active")){s.classList.add("active");var e=s.querySelector(".d-project-name .name i");e.classList.add("fa-folder-open-o"),e.classList.remove("fa-folder-o")}},setProjList:function(t,s){var e=this;this.loading=!0,Object(r["e"])().then(function(a){if(e.loading=!1,e.projList=a.data,t&&s)void 0===e.$route.params.dashId&&e.$router.push("/data-visual/dashboard/"+t+"/"+s);else{var i=e.projList[0],r=i.dashList[0];e.$router.push("/data-visual/dashboard/"+i.id+"/"+r.id)}e.$nextTick(function(){this.setActive()})}).catch(this.$handleError)},openAddProj:function(){this.projForm={name:"",remark:"",tagList:[],delTagIdList:[]},this.projFormTitle="创建文件夹",this.projFormVisible=!0},submitProjForm:function(){var t=this;this.$refs["projForm"].validate(function(s){if(!s)return!1;Object(o["b"])({id:t.projForm.id,name:t.projForm.name,remark:t.projForm.remark,addTagList:JSON.stringify(t.projForm.tagList.filter(function(t){return void 0===t.id})),delTagIdList:t.projForm.delTagIdList.toString()}).then(function(s){t.projFormVisible=!1,t.setProjList()}).catch(t.$handleError)})},openUpdateProj:function(t){this.projForm={id:t.id,name:t.name,remark:t.remark,tagList:t.tagList,delTagIdList:[]},this.projFormTitle="编辑文件夹",this.projFormVisible=!0},showProjTagInput:function(){this.projTagInputVisible=!0,this.projTagValue=""},handleProjTagInputConfirm:function(){if(this.projTagValue){if(this.projTagValue.length>50)return void this.$messageWarn("标签长度不能超过50个字符!");this.projForm.tagList.push({name:this.projTagValue})}this.projTagInputVisible=!1,this.projTagValue=""},handleCloseProjTag:function(t,s){t.id&&this.projForm.delTagIdList.push(t.id),this.projForm.tagList.splice(s,1)},openMoveProj:function(t){},openDeleteProj:function(t){var s='确认删除文件夹<strong class="d-error">"'+t.name+'"</strong>吗?',e=this;e.$confirmInfo(s,function(){Object(o["c"])({id:t.id}).then(function(t){e.activeProjId="",e.setProjList()}).catch(e.$handleError)})},clickDash:function(t,s,e){var a="/data-visual/dashboard/"+t.id+"/"+s.id;e&&(a=a+"?chartId="+e.id+"&tabId="+e.tabId),this.$router.push(a)},openAddDash:function(){this.dashForm={name:"",remark:"",projId:this.projList.length?this.projList[0].id:"",tagList:[],delTagIdList:[]},this.dashFormTitle="创建仪表盘",this.dashFormVisible=!0},openUpdateDash:function(t,s){this.dashForm={id:s.id,name:s.name,remark:s.remark,projId:t.id,tagList:s.tagList,delTagIdList:[]},this.dashFormTitle="编辑仪表盘",this.dashFormVisible=!0},submitDashForm:function(){var t=this;this.$refs["dashForm"].validate(function(s){if(!s)return!1;Object(r["b"])({id:t.dashForm.id,name:t.dashForm.name,remark:t.dashForm.remark,projId:t.dashForm.projId,addTagList:JSON.stringify(t.dashForm.tagList.filter(function(t){return void 0===t.id})),delTagIdList:t.dashForm.delTagIdList.toString()}).then(function(s){t.dashFormVisible=!1,t.setProjList(t.dashForm.projId,s.data)}).catch(t.$handleError)})},showDashTagInput:function(){this.dashTagInputVisible=!0,this.dashTagValue=""},handleDashTagInputConfirm:function(){if(this.dashTagValue){if(this.dashTagValue.length>50)return void this.$messageWarn("标签长度不能超过50个字符!");this.dashForm.tagList.push({name:this.dashTagValue})}this.dashTagInputVisible=!1,this.dashTagValue=""},handleCloseDashTag:function(t,s){t.id&&this.dashForm.delTagIdList.push(t.id),this.dashForm.tagList.splice(s,1)},openMoveDash:function(t,s){},openDeleteDash:function(t,s){var e='确认删除仪表盘<strong class="d-error">"'+s.name+'"</strong>吗?',a=this;a.$confirmInfo(e,function(){Object(r["c"])({id:s.id}).then(function(t){Number(a.activeDashId)===s.id&&(a.activeDashId=""),a.setProjList()}).catch(a.$handleError)})},openCopyDash:function(t,s){},setActive:function(){this.$nextTick(function(){var t=document.getElementById("dash_"+this.activeDashId);t&&t.classList.remove("active"),this.activeProjId=this.$route.params.projId,this.activeDashId=this.$route.params.dashId;var s=document.getElementById("dash_"+this.activeDashId);s.classList.add("active"),this.activeProj({id:this.activeProjId}),this.scrollToActiveDash()})},searchDash:function(){var t=this;this.keyword&&(this.searchResult={chartList:[],dashList:[],projList:[]},this.projList.forEach(function(s){s.name.includes(t.keyword)&&t.searchResult.projList.push({id:s.id,name:s.name}),s.dashList.forEach(function(e){e.name.includes(t.keyword)&&t.searchResult.dashList.push({id:e.id,name:e.name,proj:{id:s.id,name:s.name}}),e.chartList.forEach(function(a){a.name.includes(t.keyword)&&t.searchResult.chartList.push({id:a.id,name:a.name,tabId:a.tabId,proj:{id:s.id,name:s.name},dash:{id:e.id,name:e.name}})})})}))},clickSearchedChart:function(t){this.keyword="",this.clickDash(t.proj,t.dash,t)},clickSearchedDash:function(t){this.keyword="",this.clickDash(t.proj,t)},clickSearchedProj:function(t){this.keyword="";var s=this.projList.filter(function(s){return s.id===t.id})[0];s.dashList.length&&this.clickDash(s,s.dashList[0])},hoverDashItem:function(t,s){var e=document.getElementById("dash_detail_"+s.id);e.style.top=t.clientY-e.clientHeight/2+"px"},hoverProjItem:function(t,s){var e=document.getElementById("proj_detail_"+s.id);e.style.top=t.clientY-e.clientHeight/2+"px"},scrollToActiveDash:function(){var t=document.getElementById("dashSideMenu"),s=document.getElementById("dash_"+this.activeDashId);t.scrollTo(0,s.offsetTop-100)}},watch:{"$route.path":function(){this.setActive()},keyword:"searchDash"},mounted:function(){this.setProjList(this.$route.params.projId,this.$route.params.dashId)}},n=l,d=(e("3b1c"),e("2877")),c=Object(d["a"])(n,a,i,!1,null,null,null);s["default"]=c.exports},b179:function(t,s,e){}}]);
//# sourceMappingURL=chunk-87969b84.1e50dbab.js.map