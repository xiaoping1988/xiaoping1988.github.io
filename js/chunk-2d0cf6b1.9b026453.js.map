{"version":3,"sources":["webpack:///./src/pages/auth/user/index.vue?f716","webpack:///./src/pages/auth/user/UserRole.vue?a3b3","webpack:///src/pages/auth/user/UserRole.vue","webpack:///./src/pages/auth/user/UserRole.vue?57bf","webpack:///./src/pages/auth/user/UserRole.vue","webpack:///./src/pages/auth/user/UserCity.vue?cb93","webpack:///src/pages/auth/user/UserCity.vue","webpack:///./src/pages/auth/user/UserCity.vue?a43a","webpack:///./src/pages/auth/user/UserCity.vue","webpack:///src/pages/auth/user/index.vue","webpack:///./src/pages/auth/user/index.vue?6a21","webpack:///./src/pages/auth/user/index.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","shadow","staticStyle","width","filterable","remote","placeholder","size","remote-method","searchUser","on","change","selectUser","model","value","callback","$$v","currentUserName","expression","_l","item","key","userName","label","userNameCn","slot","_v","data","currentUserBase","columns","detailColumns","staticRenderFns","UserRolevue_type_template_id_c72c7fee_render","float","editName","submit","submitRoleGrantedForm","edit","openRoleGrantedForm","roleGranting","_e","span","suffix-icon","clearable","searchGrantRole","searchRoleKey","trim","i","_s","projName","changeCheckedRole","checkedRoleObj","projId","$set","role","j","roleId","disabled","disable","roleName","UserRolevue_type_template_id_c72c7fee_staticRenderFns","UserRolevue_type_script_lang_js_","name","props","String","projRoleGrantedList","projRoleGrantedObj","allProjRoleObj","allProjRoleForm","searchedRoleList","watch","setRoleGrantedList","methods","_this","Object","user","then","res","forEach","r","roleList","catch","$handleError","setAllProjRoleObj","_this2","setAllProjRoleForm","d","_this3","p","map","findIndex","rr","push","values","_this4","searchResult","filter","includes","length","$forceUpdate","_this5","addRoleIdList","delRelationIdList","keys","newCheckedRoleIds","ur","roleUserId","toString","user_UserRolevue_type_script_lang_js_","component","componentNormalizer","UserRole","UserCityvue_type_template_id_373c48e4_render","submitCityGrantedForm","openCityGrantedForm","cityGranting","searchGrantCity","searchCityKey","wholeCountry","changeProvinceChecked","provincesChecked","id","changeCheckedCity","checkedCityList","city","cityName","UserCityvue_type_template_id_373c48e4_staticRenderFns","UserCityvue_type_script_lang_js_","setCityGrantedList","userCityGrantedList","userCityGrantedMap","provinceCityList","searchedCityList","cityMap","c","cityId","region","setProvinceCityList","setCityMap","cityList","setProvincesChecked","setProvinceChecked","province","uncheckedWholeCountry","w","splice","_this6","delIndex","_this7","addCityList","JSON","stringify","user_UserCityvue_type_script_lang_js_","UserCity_component","UserCity","uservue_type_script_lang_js_","components","title","searchUserList","keyword","setCurrentUserBase","auth_uservue_type_script_lang_js_","user_component","__webpack_exports__"],"mappings":"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","file":"js/chunk-2d0cf6b1.9b026453.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('DPageContent',[_c('el-row',{staticClass:\"d-row\"},[_c('el-card',{attrs:{\"shadow\":\"never\"}},[_c('el-select',{staticStyle:{\"width\":\"250px\"},attrs:{\"filterable\":\"\",\"remote\":\"\",\"placeholder\":\"请输入用户名或姓名,例如xiao\",\"size\":\"small\",\"remote-method\":_vm.searchUser},on:{\"change\":_vm.selectUser},model:{value:(_vm.currentUserName),callback:function ($$v) {_vm.currentUserName=$$v},expression:\"currentUserName\"}},_vm._l((_vm.searchUserList),function(item){return _c('el-option',{key:item.userName,attrs:{\"label\":item.userNameCn + '(' + item.userName + ')',\"value\":item.userName}})}),1)],1)],1),_c('el-row',{staticClass:\"d-row\"},[_c('el-card',{attrs:{\"shadow\":\"never\"}},[_c('div',{attrs:{\"slot\":\"header\"},slot:\"header\"},[_c('span',{staticClass:\"d-card-title\"},[_vm._v(\"基本信息\")])]),_c('DDetail',{attrs:{\"data\":_vm.currentUserBase,\"columns\":_vm.detailColumns}})],1)],1),_c('el-row',{staticClass:\"d-row\"},[_c('UserRole',{attrs:{\"userName\":_vm.currentUserName,\"userNameCn\":_vm.currentUserBase.userNameCn}})],1),_c('el-row',{staticClass:\"d-row\"},[_c('UserCity',{attrs:{\"userName\":_vm.currentUserName}})],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('el-card',{attrs:{\"shadow\":\"never\"}},[_c('div',{attrs:{\"slot\":\"header\"},slot:\"header\"},[_c('span',{staticClass:\"d-card-title\"},[_vm._v(\"角色权限\")]),(_vm.userName)?_c('DEditSaveSwitch',{staticStyle:{\"float\":\"right\"},attrs:{\"editName\":\"授权\"},on:{\"submit\":_vm.submitRoleGrantedForm,\"edit\":_vm.openRoleGrantedForm},model:{value:(_vm.roleGranting),callback:function ($$v) {_vm.roleGranting=$$v},expression:\"roleGranting\"}}):_vm._e()],1),(!_vm.roleGranting)?_c('div',_vm._l((_vm.projRoleGrantedList),function(item,i){return _c('el-row',{key:i,staticClass:\"d-row\"},[_c('el-col',{attrs:{\"span\":2}},[_c('span',{staticClass:\"d-desclist-index-term\"},[_vm._v(_vm._s(item.projName))])]),_c('el-col',{attrs:{\"span\":22}},[_c('el-row',_vm._l((item.roleList),function(role,j){return _c('el-col',{key:j,attrs:{\"span\":3}},[_c('span',{staticClass:\"d-desclist-index-detail\"},[_vm._v(_vm._s(role.roleName))])])}),1)],1)],1)}),1):_c('div',[_c('el-row',{staticClass:\"d-row\"},[_c('el-col',{attrs:{\"span\":4}},[_c('el-input',{attrs:{\"suffix-icon\":\"el-icon-search\",\"size\":\"small\",\"clearable\":\"\",\"placeholder\":\"请输入角色名搜索\"},on:{\"change\":_vm.searchGrantRole},model:{value:(_vm.searchRoleKey),callback:function ($$v) {_vm.searchRoleKey=(typeof $$v === 'string'? $$v.trim(): $$v)},expression:\"searchRoleKey\"}})],1)],1),_vm._l((_vm.searchedRoleList),function(item,i){return _c('el-row',{key:i,staticClass:\"d-row\"},[_c('el-col',{attrs:{\"span\":2}},[_c('span',{staticClass:\"d-desclist-index-term\"},[_vm._v(_vm._s(item.projName))])]),_c('el-col',{attrs:{\"span\":22}},[_c('el-checkbox-group',{on:{\"change\":function (value) {_vm.changeCheckedRole(value, item)}},model:{value:(_vm.checkedRoleObj[item.projId]),callback:function ($$v) {_vm.$set(_vm.checkedRoleObj, item.projId, $$v)},expression:\"checkedRoleObj[item.projId]\"}},_vm._l((item.roleList),function(role,j){return _c('el-checkbox',{key:j,attrs:{\"label\":role.roleId,\"disabled\":role.disable}},[_vm._v(_vm._s(role.roleName))])}),1)],1)],1)})],2)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n    <el-card shadow=\"never\">\r\n        <div slot=\"header\">\r\n            <span class=\"d-card-title\">角色权限</span>\r\n            <DEditSaveSwitch v-if=\"userName\"\r\n                             style=\"float: right\"\r\n                             editName=\"授权\"\r\n                             v-model=\"roleGranting\"\r\n                             @submit=\"submitRoleGrantedForm\"\r\n                             @edit=\"openRoleGrantedForm\"></DEditSaveSwitch>\r\n        </div>\r\n        <div v-if=\"!roleGranting\">\r\n            <el-row v-for=\"(item, i) in projRoleGrantedList\" :key=\"i\" class=\"d-row\">\r\n                <el-col :span=\"2\">\r\n                    <span class=\"d-desclist-index-term\">{{item.projName}}</span>\r\n                </el-col>\r\n                <el-col :span=\"22\">\r\n                    <el-row>\r\n                        <el-col v-for=\"(role, j) in item.roleList\" :key=\"j\" :span=\"3\">\r\n                            <span class=\"d-desclist-index-detail\">{{role.roleName}}</span>\r\n                        </el-col>\r\n                    </el-row>\r\n                </el-col>\r\n            </el-row>\r\n        </div>\r\n        <div v-else>\r\n            <el-row  class=\"d-row\">\r\n                <el-col :span=\"4\">\r\n                    <el-input suffix-icon=\"el-icon-search\"\r\n                              size=\"small\"\r\n                              clearable\r\n                              v-model.trim=\"searchRoleKey\"\r\n                              @change=\"searchGrantRole\"\r\n                              placeholder=\"请输入角色名搜索\"></el-input>\r\n                </el-col>\r\n            </el-row>\r\n            <el-row v-for=\"(item, i) in searchedRoleList\" :key=\"i\"  class=\"d-row\">\r\n                <el-col :span=\"2\">\r\n                    <span class=\"d-desclist-index-term\">{{item.projName}}</span>\r\n                </el-col>\r\n                <el-col :span=\"22\">\r\n                    <el-checkbox-group v-model=\"checkedRoleObj[item.projId]\"\r\n                                       @change=\"(value) => {changeCheckedRole(value, item)}\">\r\n                        <el-checkbox v-for=\"(role, j) in item.roleList\"\r\n                                     :key=\"j\"\r\n                                     :label=\"role.roleId\"\r\n                                     :disabled=\"role.disable\">{{role.roleName}}</el-checkbox>\r\n                    </el-checkbox-group>\r\n                </el-col>\r\n            </el-row>\r\n        </div>\r\n    </el-card>\r\n</template>\r\n\r\n<script>\r\n    import {\r\n        listUserRole,\r\n        grantUserRole\r\n    } from '../../../services/auth/user'\r\n    import {\r\n        listProjRole\r\n    } from '../../../services/auth/role'\r\n    export default {\r\n        name: 'UserRole',\r\n        props: {\r\n            userName: String,\r\n            userNameCn: String\r\n        },\r\n        data () {\r\n            return {\r\n                projRoleGrantedList: [], // 用户已有的角色权限，数组\r\n                projRoleGrantedObj: {}, // 用户已有的角色权限，kv,key是projId,value是roleList\r\n                checkedRoleObj: {},\r\n                roleGranting: false,\r\n                allProjRoleObj: null, // 登录用户可以操作授权的角色列表\r\n                allProjRoleForm: {},\r\n                searchRoleKey: '',\r\n                searchedRoleList: []\r\n            }\r\n        },\r\n        watch: {\r\n            userName: function () {\r\n                this.setRoleGrantedList()\r\n            }\r\n        },\r\n        methods: {\r\n            setRoleGrantedList () {\r\n                this.roleGranting = false\r\n                this.projRoleGrantedList = []\r\n                this.projRoleGrantedObj = {}\r\n                listUserRole({\r\n                    userName: this.userName\r\n                }).then(res => {\r\n                    this.projRoleGrantedList = res.data\r\n                    this.projRoleGrantedList.forEach(r => {\r\n                        this.projRoleGrantedObj[r.projId] = r.roleList\r\n                    })\r\n                }).catch(this.$handleError)\r\n            },\r\n            setAllProjRoleObj () {\r\n                if (this.allProjRoleObj) {\r\n                    this.setAllProjRoleForm()\r\n                    return\r\n                }\r\n                this.allProjRoleObj = {}\r\n                listProjRole().then(res => {\r\n                    res.data.forEach(d => {\r\n                        this.allProjRoleObj[d.projId] = d\r\n                    })\r\n                    this.setAllProjRoleForm()\r\n                }).catch(this.$handleError)\r\n            },\r\n            openRoleGrantedForm () {\r\n                this.searchRoleKey = ''\r\n                this.setAllProjRoleObj()\r\n            },\r\n            setAllProjRoleForm () {\r\n                this.checkedRoleObj = {}\r\n                this.allProjRoleForm = {}\r\n                this.projRoleGrantedList.forEach(p => {\r\n                    this.checkedRoleObj[p.projId] = p.roleList.map(r => r.roleId)\r\n                    this.allProjRoleForm[p.projId] = {\r\n                        projId: p.projId,\r\n                        projName: p.projName,\r\n                        roleList: []\r\n                    }\r\n                    if (this.allProjRoleObj[p.projId]) {\r\n                        this.allProjRoleForm[p.projId].roleList = this.allProjRoleObj[p.projId].roleList.map(r => {\r\n                            return {\r\n                                roleId: r.roleId,\r\n                                roleName: r.roleName\r\n                            }\r\n                        })\r\n                        p.roleList.forEach(r => {\r\n                            if (this.allProjRoleForm[p.projId].roleList.findIndex(rr => rr.roleId === r.roleId) === -1) {\r\n                                this.allProjRoleForm[p.projId].roleList.push({\r\n                                    roleId: r.roleId,\r\n                                    roleName: r.roleName,\r\n                                    disable: true\r\n                                })\r\n                            }\r\n                        })\r\n                    } else {\r\n                        this.allProjRoleForm[p.projId].roleList = p.roleList.map(r => {\r\n                            return {\r\n                                roleId: r.roleId,\r\n                                roleName: r.roleName,\r\n                                disable: true\r\n                            }\r\n                        })\r\n                    }\r\n                })\r\n                Object.values(this.allProjRoleObj).forEach(p => {\r\n                    if (!this.allProjRoleForm[p.projId]) {\r\n                        this.checkedRoleObj[p.projId] = []\r\n                        this.allProjRoleForm[p.projId] = {\r\n                            projId: p.projId,\r\n                            projName: p.projName,\r\n                            roleList: []\r\n                        }\r\n                        this.allProjRoleForm[p.projId].roleList = this.allProjRoleObj[p.projId].roleList.map(r => {\r\n                            return {\r\n                                roleId: r.roleId,\r\n                                roleName: r.roleName\r\n                            }\r\n                        })\r\n                    }\r\n                })\r\n                this.searchGrantRole()\r\n            },\r\n            searchGrantRole () {\r\n                this.searchedRoleList = []\r\n                if (!this.searchRoleKey) {\r\n                    this.searchedRoleList = Object.values(this.allProjRoleForm)\r\n                } else {\r\n                    Object.values(this.allProjRoleForm).forEach(p => {\r\n                        let searchResult = p.roleList.filter(r => r.roleName.includes(this.searchRoleKey))\r\n                        if (searchResult.length) {\r\n                            this.searchedRoleList.push({\r\n                                projId: p.projId,\r\n                                projName: p.projName,\r\n                                roleList: searchResult\r\n                            })\r\n                        }\r\n                    })\r\n                }\r\n            },\r\n            changeCheckedRole (value, item) {\r\n                this.$forceUpdate()\r\n            },\r\n            submitRoleGrantedForm () {\r\n                let addRoleIdList = [] // 新授权的角色ID集合\r\n                let delRelationIdList = [] // 勾掉的角色的关系ID集合\r\n                Object.keys(this.checkedRoleObj).forEach(projId => {\r\n                    let newCheckedRoleIds = this.checkedRoleObj[projId]\r\n                    if (this.projRoleGrantedObj[projId]) {\r\n                        this.projRoleGrantedObj[projId].forEach(ur => {\r\n                            if (!newCheckedRoleIds.includes(ur.roleId)) {\r\n                                delRelationIdList.push(ur.roleUserId)\r\n                            }\r\n                        })\r\n                    }\r\n\r\n                    newCheckedRoleIds.forEach(roleId => {\r\n                        let i = -1\r\n                        if (this.projRoleGrantedObj[projId]) {\r\n                            i = this.projRoleGrantedObj[projId].findIndex(ur => ur.roleId === roleId)\r\n                        }\r\n                        if (i === -1) {\r\n                            addRoleIdList.push(roleId)\r\n                        }\r\n                    })\r\n                })\r\n                grantUserRole({\r\n                    userName: this.userName,\r\n                    userNameCn: this.userNameCn,\r\n                    addRoleIdList: addRoleIdList.toString(),\r\n                    delRelationIdList: delRelationIdList.toString()\r\n                }).then(res => {\r\n                    this.setRoleGrantedList()\r\n                }).catch(this.$handleError)\r\n            }\r\n        }\r\n    }\r\n</script>","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./UserRole.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./UserRole.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./UserRole.vue?vue&type=template&id=c72c7fee&\"\nimport script from \"./UserRole.vue?vue&type=script&lang=js&\"\nexport * from \"./UserRole.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('el-card',{attrs:{\"shadow\":\"never\"}},[_c('div',{attrs:{\"slot\":\"header\"},slot:\"header\"},[_c('span',{staticClass:\"d-card-title\"},[_vm._v(\"城市权限\")]),(_vm.userName)?_c('DEditSaveSwitch',{staticStyle:{\"float\":\"right\"},attrs:{\"editName\":\"授权\"},on:{\"submit\":_vm.submitCityGrantedForm,\"edit\":_vm.openCityGrantedForm},model:{value:(_vm.cityGranting),callback:function ($$v) {_vm.cityGranting=$$v},expression:\"cityGranting\"}}):_vm._e()],1),(!_vm.cityGranting)?_c('div',[_c('el-row',{staticClass:\"d-row\"},_vm._l((_vm.userCityGrantedList),function(item,i){return _c('el-col',{key:i,attrs:{\"span\":1}},[_c('span',{staticClass:\"d-desclist-index-detail\"},[_vm._v(_vm._s(item.cityName))])])}),1)],1):_c('div',[_c('el-row',{staticClass:\"d-row\"},[_c('el-col',{attrs:{\"span\":4}},[_c('el-input',{attrs:{\"suffix-icon\":\"el-icon-search\",\"size\":\"small\",\"clearable\":\"\",\"placeholder\":\"请输入城市名搜索\"},on:{\"change\":_vm.searchGrantCity},model:{value:(_vm.searchCityKey),callback:function ($$v) {_vm.searchCityKey=(typeof $$v === 'string'? $$v.trim(): $$v)},expression:\"searchCityKey\"}})],1)],1),_c('el-row',{staticClass:\"d-row\"},[_c('el-col',{attrs:{\"span\":2}},[_c('el-checkbox',{model:{value:(_vm.wholeCountry),callback:function ($$v) {_vm.wholeCountry=$$v},expression:\"wholeCountry\"}},[_vm._v(\"全国\")])],1)],1),_vm._l((_vm.searchedCityList),function(item,i){return _c('el-row',{key:i,staticClass:\"d-row\"},[_c('el-col',{attrs:{\"span\":2}},[_c('el-checkbox',{on:{\"change\":function (value) { return _vm.changeProvinceChecked(value, item); }},model:{value:(_vm.provincesChecked[item.id]),callback:function ($$v) {_vm.$set(_vm.provincesChecked, item.id, $$v)},expression:\"provincesChecked[item.id]\"}},[_vm._v(_vm._s(item.name))])],1),_c('el-col',{attrs:{\"span\":22}},[_c('el-checkbox-group',{on:{\"change\":function (value) {_vm.changeCheckedCity(value, item)}},model:{value:(_vm.checkedCityList),callback:function ($$v) {_vm.checkedCityList=$$v},expression:\"checkedCityList\"}},_vm._l((item.cityList),function(city,j){return _c('el-checkbox',{key:j,attrs:{\"label\":city.id}},[_vm._v(_vm._s(city.name))])}),1)],1)],1)})],2)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n    <el-card shadow=\"never\">\r\n        <div slot=\"header\">\r\n            <span class=\"d-card-title\">城市权限</span>\r\n            <DEditSaveSwitch v-if=\"userName\"\r\n                             v-model=\"cityGranting\"\r\n                             style=\"float: right\"\r\n                             editName=\"授权\"\r\n                             @submit=\"submitCityGrantedForm\"\r\n                             @edit=\"openCityGrantedForm\"></DEditSaveSwitch>\r\n        </div>\r\n        <div v-if=\"!cityGranting\">\r\n            <el-row class=\"d-row\">\r\n                <el-col :span=\"1\" v-for=\"(item, i) in userCityGrantedList\" :key=\"i\" >\r\n                    <span class=\"d-desclist-index-detail\">{{item.cityName}}</span>\r\n                </el-col>\r\n            </el-row>\r\n        </div>\r\n        <div v-else>\r\n            <el-row  class=\"d-row\">\r\n                <el-col :span=\"4\">\r\n                    <el-input suffix-icon=\"el-icon-search\"\r\n                              size=\"small\"\r\n                              clearable\r\n                              v-model.trim=\"searchCityKey\"\r\n                              @change=\"searchGrantCity\"\r\n                              placeholder=\"请输入城市名搜索\"></el-input>\r\n                </el-col>\r\n            </el-row>\r\n            <el-row class=\"d-row\">\r\n                <el-col :span=\"2\">\r\n                    <el-checkbox v-model=\"wholeCountry\">全国</el-checkbox>\r\n                </el-col>\r\n            </el-row>\r\n            <el-row v-for=\"(item, i) in searchedCityList\" :key=\"i\"  class=\"d-row\">\r\n                <el-col :span=\"2\">\r\n                    <el-checkbox v-model=\"provincesChecked[item.id]\" @change=\"(value) => changeProvinceChecked(value, item)\">{{item.name}}</el-checkbox>\r\n                </el-col>\r\n                <el-col :span=\"22\">\r\n                    <el-checkbox-group v-model=\"checkedCityList\"\r\n                                       @change=\"(value) => {changeCheckedCity(value, item)}\">\r\n                        <el-checkbox v-for=\"(city, j) in item.cityList\"\r\n                                     :key=\"j\"\r\n                                     :label=\"city.id\">{{city.name}}</el-checkbox>\r\n                    </el-checkbox-group>\r\n                </el-col>\r\n            </el-row>\r\n        </div>\r\n    </el-card>\r\n</template>\r\n\r\n<script>\r\n    import {\r\n        listUserCity,\r\n        grantUserCity\r\n    } from '../../../services/auth/user'\r\n    import {\r\n        listProvinceCity,\r\n        WholeCountry\r\n    } from '../../../services/auth/region'\r\n    export default {\r\n        name: 'UserCity',\r\n        props: {\r\n            userName: String\r\n        },\r\n        watch: {\r\n            userName: function () {\r\n                this.setCityGrantedList()\r\n            }\r\n        },\r\n        data () {\r\n            return {\r\n                userCityGrantedList: [], // 用户已有的城市权限\r\n                userCityGrantedMap: {},\r\n                cityGranting: false,\r\n                provinceCityList: null,\r\n                checkedCityList: [],\r\n                searchCityKey: '',\r\n                searchedCityList: [],\r\n                wholeCountry: false,\r\n                provincesChecked: {},\r\n                cityMap: {}\r\n            }\r\n        },\r\n        methods: {\r\n            setCityGrantedList () {\r\n                this.cityGranting = false\r\n                this.checkedCityList = []\r\n                listUserCity({\r\n                    userName: this.userName\r\n                }).then(res => {\r\n                    this.userCityGrantedList = res.data\r\n                    this.userCityGrantedList.forEach(c => {\r\n                        this.userCityGrantedMap[c.cityId] = c\r\n                        if (c.cityId === WholeCountry.id) {\r\n                            this.wholeCountry = true\r\n                        } else {\r\n                            this.checkedCityList.push(c.cityId)\r\n                        }\r\n                    })\r\n                    if (this.wholeCountry) {\r\n                        this.checkedCityList = [WholeCountry.id]\r\n                    }\r\n                }).catch(this.$handleError)\r\n            },\r\n            openCityGrantedForm () {\r\n                this.cityGranting = true\r\n                this.searchCityKey = ''\r\n                this.setProvinceCityList()\r\n            },\r\n            setProvinceCityList () {\r\n                if (this.provinceCityList) {\r\n                    this.searchGrantCity()\r\n                    return\r\n                }\r\n                listProvinceCity().then(res => {\r\n                    this.provinceCityList = res.data\r\n                    this.setCityMap()\r\n                    this.searchGrantCity()\r\n                }).catch(this.$handleError)\r\n            },\r\n            setCityMap () {\r\n                this.cityMap[WholeCountry.id] = WholeCountry\r\n                this.provinceCityList.forEach(p => {\r\n                    p.cityList.forEach(c => {\r\n                        this.cityMap[c.id] = c\r\n                    })\r\n                })\r\n            },\r\n            searchGrantCity () {\r\n                this.searchedCityList = []\r\n                if (!this.searchCityKey) {\r\n                    this.searchedCityList = this.provinceCityList\r\n                } else {\r\n                    this.provinceCityList.forEach(p => {\r\n                        let cityList = []\r\n                        p.cityList.forEach(c => {\r\n                            if (c.name.includes(this.searchCityKey)) {\r\n                                cityList.push(c)\r\n                            }\r\n                        })\r\n                        if (cityList.length) {\r\n                            this.searchedCityList.push({\r\n                                id: p.id,\r\n                                name: p.name,\r\n                                cityList: cityList\r\n                            })\r\n                        }\r\n                    })\r\n                }\r\n                this.setProvincesChecked()\r\n            },\r\n            setProvincesChecked () {\r\n                this.searchedCityList.forEach(p => {\r\n                    this.setProvinceChecked(p)\r\n                })\r\n            },\r\n            setProvinceChecked (province) {\r\n                this.provincesChecked[province.id] = true\r\n                for (let i in province.cityList) {\r\n                    if (!this.checkedCityList.includes(province.cityList[i].id)) {\r\n                        this.provincesChecked[province.id] = false\r\n                        break\r\n                    }\r\n                }\r\n            },\r\n            uncheckedWholeCountry () {\r\n                this.wholeCountry = false\r\n                let w = this.checkedCityList.findIndex(cityId => cityId === WholeCountry.id)\r\n                if (w >= 0) {\r\n                    this.checkedCityList.splice(w, 1)\r\n                }\r\n            },\r\n            changeCheckedCity (value, province) {\r\n                this.uncheckedWholeCountry()\r\n                this.setProvinceChecked(province)\r\n                this.$forceUpdate()\r\n            },\r\n            changeProvinceChecked (value, province) {\r\n                this.uncheckedWholeCountry()\r\n                if (value) {\r\n                    province.cityList.forEach(c => {\r\n                        if (!this.checkedCityList.includes(c.id)) {\r\n                            this.checkedCityList.push(c.id)\r\n                        }\r\n                    })\r\n                } else {\r\n                    let delIndex = []\r\n                    this.checkedCityList.forEach((cityId, i) => {\r\n                        let j = province.cityList.findIndex(c => c.id === cityId)\r\n                        if (j >= 0) {\r\n                            delIndex.push(i)\r\n                        }\r\n                    })\r\n                    delIndex.forEach((d, i) => {\r\n                        this.checkedCityList.splice(d - i, 1)\r\n                    })\r\n                }\r\n            },\r\n            submitCityGrantedForm () {\r\n                let addCityList = []\r\n                let delRelationIdList = []\r\n                this.checkedCityList.forEach(cityId => {\r\n                    if (!this.userCityGrantedMap[cityId]) {\r\n                        addCityList.push({\r\n                            cityId: this.cityMap[cityId].id,\r\n                            cityName: this.cityMap[cityId].name\r\n                        })\r\n                    }\r\n                })\r\n                this.userCityGrantedList.forEach(c => {\r\n                    if (!this.checkedCityList.includes(c.cityId)) {\r\n                        delRelationIdList.push(c.id)\r\n                    }\r\n                })\r\n                grantUserCity({\r\n                    userName: this.userName,\r\n                    addCityList: JSON.stringify(addCityList),\r\n                    delRelationIdList: delRelationIdList.toString()\r\n                }).then(res => {\r\n                    this.setCityGrantedList()\r\n                }).catch(this.$handleError)\r\n            }\r\n        }\r\n    }\r\n</script>","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./UserCity.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./UserCity.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./UserCity.vue?vue&type=template&id=373c48e4&\"\nimport script from \"./UserCity.vue?vue&type=script&lang=js&\"\nexport * from \"./UserCity.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","<template>\r\n    <DPageContent>\r\n        <el-row class=\"d-row\">\r\n            <el-card shadow=\"never\">\r\n                <el-select filterable\r\n                           remote\r\n                           placeholder=\"请输入用户名或姓名,例如xiao\"\r\n                           size=\"small\"\r\n                           v-model=\"currentUserName\"\r\n                           @change=\"selectUser\"\r\n                           :remote-method=\"searchUser\"\r\n                           style=\"width: 250px\">\r\n                    <el-option\r\n                            v-for=\"item in searchUserList\"\r\n                            :key=\"item.userName\"\r\n                            :label=\"item.userNameCn + '(' + item.userName + ')'\"\r\n                            :value=\"item.userName\">\r\n                    </el-option>\r\n                </el-select>\r\n            </el-card>\r\n        </el-row>\r\n        <el-row class=\"d-row\">\r\n            <el-card shadow=\"never\">\r\n                <div slot=\"header\">\r\n                    <span class=\"d-card-title\">基本信息</span>\r\n                </div>\r\n                <DDetail :data=\"currentUserBase\" :columns=\"detailColumns\"></DDetail>\r\n            </el-card>\r\n        </el-row>\r\n        <el-row class=\"d-row\">\r\n            <UserRole :userName=\"currentUserName\" :userNameCn=\"currentUserBase.userNameCn\"></UserRole>\r\n        </el-row>\r\n        <el-row class=\"d-row\">\r\n            <UserCity :userName=\"currentUserName\"></UserCity>\r\n        </el-row>\r\n    </DPageContent>\r\n</template>\r\n\r\n<script>\r\n    import {\r\n        searchUser,\r\n        getUserBase\r\n    } from '../../../services/auth/user'\r\n    import UserRole from './UserRole.vue'\r\n    import UserCity from './UserCity.vue'\r\n    export default {\r\n        name: 'DUser',\r\n        components: {UserRole, UserCity},\r\n        data () {\r\n            return {\r\n                currentUserName: '',\r\n                currentUserBase: {},\r\n                detailColumns: [\r\n                    {key: 'userNameCn', title: '姓名'},\r\n                    {key: 'userName', title: '用户名'},\r\n                    {key: 'departmentName', title: '部门'},\r\n                    {key: 'phone', title: '手机号'},\r\n                    {key: 'email', title: '邮箱'}\r\n                ],\r\n                searchUserList: []\r\n            }\r\n        },\r\n        methods: {\r\n            searchUser (keyword) {\r\n                if (keyword) {\r\n                    searchUser({\r\n                        keyword: keyword\r\n                    }).then(res => {\r\n                        this.searchUserList = res.data\r\n                    }).catch(this.$handleError)\r\n                }\r\n            },\r\n            selectUser () {\r\n                this.setCurrentUserBase()\r\n            },\r\n            setCurrentUserBase () {\r\n                getUserBase({\r\n                    userName: this.currentUserName\r\n                }).then(res => {\r\n                    this.currentUserBase = res.data\r\n                }).catch(this.$handleError)\r\n            }\r\n        }\r\n    }\r\n</script>","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=03ee93da&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}